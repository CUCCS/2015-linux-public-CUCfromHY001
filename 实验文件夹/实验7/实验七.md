## 第七次实验报告 使用ansible技术重构FTP、NFS、DHCP、DNS、Samba服务器的自动安装与自动配置
***
### 实验目的
- 掌握ansible的相关知识。

### 实验环境
* 虚拟机物理环境
	* Server : Ubuntu-16.04-Server
	* Target : Ubuntu-16.04-Server
* 网络环境
	* Server
		* NAT
		* Host-Only:192.168.150.2
	* Target
		* NAT
		* Host-Only:192.168.150.3
### 实验步骤
* 设置免密登陆 

![image](https://raw.githubusercontent.com/CUCfromHY001/2015-linux-public-CUCfromHY001/HW7/%E5%AE%9E%E9%AA%8C%E6%96%87%E4%BB%B6%E5%A4%B9/%E5%AE%9E%E9%AA%8C7/Image/0.5.PNG)

* 在Server上配置本地Ansible本地工作目录


![image](https://raw.githubusercontent.com/CUCfromHY001/2015-linux-public-CUCfromHY001/HW7/%E5%AE%9E%E9%AA%8C%E6%96%87%E4%BB%B6%E5%A4%B9/%E5%AE%9E%E9%AA%8C7/Image/1.PNG)

* 查看结构

![image](https://raw.githubusercontent.com/CUCfromHY001/2015-linux-public-CUCfromHY001/HW7/%E5%AE%9E%E9%AA%8C%E6%96%87%E4%BB%B6%E5%A4%B9/%E5%AE%9E%E9%AA%8C7/Image/2.PNG)

* 运行代码

![image](https://raw.githubusercontent.com/CUCfromHY001/2015-linux-public-CUCfromHY001/HW7/%E5%AE%9E%E9%AA%8C%E6%96%87%E4%BB%B6%E5%A4%B9/%E5%AE%9E%E9%AA%8C7/Image/3.PNG)


### 实验结果
- 完成FTP服务器的自动部署
- 完成NFS服务器的自动部署
- 完成Samba服务器的自动部署
- 完成DHCP服务器的自动部署（实验六未完成）
- 未完成DNS服务器的自动部署

* 以FTP服务器为例检查

![image](https://raw.githubusercontent.com/CUCfromHY001/2015-linux-public-CUCfromHY001/HW7/%E5%AE%9E%E9%AA%8C%E6%96%87%E4%BB%B6%E5%A4%B9/%E5%AE%9E%E9%AA%8C7/Image/4.PNG)

### 问题
使用`ansible-playbook`指令时弹出`unreachable error`，
```
ansible-playbook: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
```
查阅文档，后运行成功。相关文档在参考链接放出。

### 参考链接

- [unreachable error](https://github.com/ansible/ansible/issues/33321)
- [unreachable error](https://github.com/ansible/ansible/issues/15321)
